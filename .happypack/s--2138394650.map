{"version":3,"sources":["app\\renderer\\main\\pages\\ProjectChangesPage\\ProjectChangesPage.jsx"],"names":[],"mappings":"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","file":"ProjectChangesPage.jsx","sourceRoot":"C:/Users/david/repositories/stemn-electron-2","sourcesContent":["// Container Core\nimport { bindActionCreators } from 'redux';\nimport { connect } from 'react-redux';\n\n// Container Actions\nimport * as ChangesActions from 'app/renderer/main/modules/Changes/Changes.actions.js';\n\n// Component Core\nimport React from 'react';\n\nimport i from 'icepick';\nimport { has } from 'lodash';\n\n// Styles\nimport classNames from 'classnames';\n\n// Sub Components\nimport { Link }             from 'react-router';\nimport ContentSidebar       from 'app/renderer/main/components/ContentSidebar';\nimport LoadingOverlay       from 'app/renderer/main/components/Loading/LoadingOverlay/LoadingOverlay.jsx';\nimport Timeline             from 'app/renderer/main/modules/Timeline/Timeline.jsx';\nimport CommitChanges        from 'app/renderer/main/modules/Changes/CommitChanges/CommitChanges.jsx';\nimport CommitBox            from 'app/renderer/main/modules/Changes/CommitBox/CommitBox.jsx'\nimport FileCompareStandard  from 'app/renderer/main/modules/FileCompare/FileCompareStandard/FileCompareStandard.jsx';\nimport cloudLocked          from 'app/renderer/assets/images/pure-vectors/cloud-locked.svg';\nimport file               from 'app/renderer/assets/images/pure-vectors/file.svg';\n\n\n///////////////////////////////// COMPONENT /////////////////////////////////\n\nconst CommitBoxStyles = {\n  borderTop: '1px solid rgba(0, 0, 0, 0.1)',\n  background: 'rgba(0, 0, 0, 0.03)'\n};\n\nexport const Component = React.createClass({\n  propTypes: {\n    project: React.PropTypes.object.isRequired,\n  },\n\n  componentWillMount() {\n    if(this.props.project && this.props.project.data && this.props.project.data.remote.connected){\n      this.props.changesActions.fetchChanges({\n        projectId: this.props.project.data._id\n      })\n    }\n  },\n\n  componentWillReceiveProps(nextProps) {\n    if (this.props.project && nextProps.project && this.props.project.data && nextProps.project.data._id !== this.props.project.data._id && nextProps.project.data.remote.connected) {\n      this.props.changesActions.fetchChanges({\n        projectId: nextProps.project.data._id\n      })\n    }\n  },\n\n  refresh(){\n    this.props.changesActions.fetchChanges({\n      projectId: this.props.project.data._id\n    })\n  },\n\n  toggleAll({value}){\n    return this.props.changesActions.toggleAll({\n      value,\n      projectId: this.props.project.data._id\n    })\n  },\n\n  commitFn(){\n    this.props.changesActions.commit({\n      projectId: this.props.project.data._id,\n      summary: this.props.changes.summary,\n      description: this.props.changes.description\n    })\n  },\n\n  deselect(){\n    this.props.changesActions.deselect({\n      projectId: this.props.project.data._id\n    })\n  },\n  render() {\n    const { changes, project, changesActions, entityModel, dispatch } = this.props;\n\n    if(!project || !project.data){\n      return <LoadingOverlay />\n    }\n\n    const baseLink = `project/${project.data._id}`;\n\n    if(project.data.remote.connected){\n      if(!changes){\n        return <LoadingOverlay />\n      }\n      const filePrevious = has(changes, 'selected.data.previousRevisionId')\n        ? i.assocIn(changes.selected.data, ['revisionId'], changes.selected.data.previousRevisionId)\n        : null;\n\n      return (\n        <div className=\"layout-column flex rel-box\">\n          <div className=\"layout-row flex\">\n            <div className=\"layout-column\">\n              <ContentSidebar>\n                {changes && changes.data\n                  ? <CommitChanges\n                      changes={changes}\n                      project={project.data}\n                      toggleAll={this.toggleAll}\n                      selectedFileChange={changesActions.selectedFileChange}\n                      refresh={this.refresh}\n                      deselect={this.deselect}\n                      dispatch={dispatch}\n                    />\n                  : ''}\n\n                <div style={CommitBoxStyles}>\n                  <CommitBox\n                    entityModel={entityModel}\n                    changes={changes}\n                    changesActions={changesActions}\n                    commitFn={()=>this.commitFn()}\n                    project={project.data}\n                  />\n                </div>\n              </ContentSidebar>\n            </div>\n            <div className=\"layout-column flex\">\n              {changes.selected && changes.selected.data\n                ?\n                <FileCompareStandard\n                  compareId={`changes-${project.data._id}-${changes.selected._id}`}\n                  project={project.data}\n                  file1={changes.selected.data}\n                  file2={filePrevious} />\n                : (\n                <div className=\"layout-column layout-align-center-center flex text-title-4 text-center\">\n                  <img src={file} style={{width: '100px'}}/>\n                  <div>No file change selected.</div>\n                </div>)\n              }\n            </div>\n\n          </div>\n        </div>\n      );\n    }\n    else{\n      return (\n        <div className=\"layout-column layout-align-center-center flex\">\n          <img src={cloudLocked}/>\n          <div className=\"text-title-4 text-center\">Changes not available. Connect this project to Drive or Dropbox</div>\n          <div className=\"text-title-4 text-center link-primary\" style={{marginTop: '10px'}}><Link to={baseLink+'/settings'}>Add File Store</Link></div>\n        </div>\n      )\n    }\n  }\n});\n\n\n///////////////////////////////// CONTAINER /////////////////////////////////\n\nfunction mapStateToProps({changes, projects}, {params}) {\n  const project = projects.data[params.stub];\n  return {\n    project: project,\n    changes: changes[params.stub],\n    entityModel: `changes.${params.stub}`\n  };\n}\n\n\nfunction mapDispatchToProps(dispatch) {\n  return {\n    changesActions: bindActionCreators(ChangesActions, dispatch),\n    dispatch: dispatch\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Component);\n"]}