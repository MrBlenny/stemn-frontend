'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Component = undefined;

var _index = require('C:\\Users\\david\\repositories\\stemn-electron-2\\node_modules\\redbox-react\\lib\\index.js');

var _index2 = _interopRequireDefault(_index);

var _index3 = require('C:\\Users\\david\\repositories\\stemn-electron-2\\node_modules\\react-transform-catch-errors\\lib\\index.js');

var _index4 = _interopRequireDefault(_index3);

var _react2 = require('react');

var _react3 = _interopRequireDefault(_react2);

var _index5 = require('C:\\Users\\david\\repositories\\stemn-electron-2\\node_modules\\react-transform-hmr\\lib\\index.js');

var _index6 = _interopRequireDefault(_index5);

var _redux = require('redux');

var _reactRedux = require('react-redux');

var _ElectronWindowsActions = require('app/shared/modules/ElectronWindows/ElectronWindows.actions.js');

var ElectronWindowsActions = _interopRequireWildcard(_ElectronWindowsActions);

var _system = require('app/shared/actions/system');

var SystemActions = _interopRequireWildcard(_system);

var _PreviewFileUtils = require('app/renderer/main/modules/Files/PreviewFile/PreviewFile.utils.js');

var _classnames = require('classnames');

var _classnames2 = _interopRequireDefault(_classnames);

var _PopoverMenu = require('app/renderer/main/components/PopoverMenu/PopoverMenu');

var _PopoverMenu2 = _interopRequireDefault(_PopoverMenu);

var _PopoverMenuList = require('app/renderer/main/components/PopoverMenu/PopoverMenuList');

var _PopoverMenuList2 = _interopRequireDefault(_PopoverMenuList);

var _SimpleIconButton = require('app/renderer/main/components/Buttons/SimpleIconButton/SimpleIconButton');

var _SimpleIconButton2 = _interopRequireDefault(_SimpleIconButton);

var _FileCompareUtils = require('../FileCompare.utils.js');

var _moreHoriz = require('react-icons/md/more-horiz');

var _moreHoriz2 = _interopRequireDefault(_moreHoriz);

var _openInNew = require('react-icons/md/open-in-new');

var _openInNew2 = _interopRequireDefault(_openInNew);

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) newObj[key] = obj[key]; } } newObj.default = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

var _components = {
  _component: {}
};

var _CUsersDavidRepositoriesStemnElectron2Node_modulesReactTransformHmrLibIndexJs2 = (0, _index6.default)({
  filename: 'C:/Users/david/repositories/stemn-electron-2/app/renderer/main/modules/FileCompare/FileCompareMenu/FileCompareMenu.jsx',
  components: _components,
  locals: [module],
  imports: [_react3.default]
});

var _CUsersDavidRepositoriesStemnElectron2Node_modulesReactTransformCatchErrorsLibIndexJs2 = (0, _index4.default)({
  filename: 'C:/Users/david/repositories/stemn-electron-2/app/renderer/main/modules/FileCompare/FileCompareMenu/FileCompareMenu.jsx',
  components: _components,
  locals: [],
  imports: [_react3.default, _index2.default]
});

function _wrapComponent(id) {
  return function (Component) {
    return _CUsersDavidRepositoriesStemnElectron2Node_modulesReactTransformHmrLibIndexJs2(_CUsersDavidRepositoriesStemnElectron2Node_modulesReactTransformCatchErrorsLibIndexJs2(Component, id), id);
  };
} /**************************************************************************
  We pass in either revisions or file1 + file2.
  **************************************************************************/

// Container Core


// Container Actions


// Component Core


// Styles


// Sub Components


///////////////////////////////// COMPONENT /////////////////////////////////

var Component = exports.Component = _wrapComponent('_component')(_react3.default.createClass({
  displayName: 'Component',
  menu: function menu() {
    var _props = this.props;
    var file1 = _props.file1;
    var dispatch = _props.dispatch;
    var isChange = _props.isChange;

    var discardChanges = {
      label: 'Discard Changes',
      onClick: function onClick() {}
    };
    var openFile = {
      label: 'Open File',
      onClick: function onClick() {
        dispatch(SystemActions.openFile({
          path: file1.path,
          projectId: file1.project._id,
          provider: file1.provider
        }));
      }
    };
    var openFolder = {
      label: 'Open Containing Folder',
      onClick: function onClick() {
        dispatch(SystemActions.openFile({
          location: true,
          path: file1.path,
          projectId: file1.project._id,
          provider: file1.provider
        }));
      }
    };
    return isChange ? [discardChanges, openFile, openFolder] : [openFile, openFolder];
  },
  preview: function preview() {
    var _props2 = this.props;
    var file1 = _props2.file1;
    var dispatch = _props2.dispatch;

    dispatch(ElectronWindowsActions.create({
      type: 'PREVIEW',
      props: {
        fileId: file1.fileId,
        revisionId: file1.revisionId,
        projectId: file1.project._id
      }
    }));
  },
  render: function render() {
    var _props3 = this.props;
    var enablePreview = _props3.enablePreview;
    var mode = _props3.mode;
    var changeMode = _props3.changeMode;
    var revisions = _props3.revisions;
    var file1 = _props3.file1;
    var file2 = _props3.file2;
    var dispatch = _props3.dispatch;


    if (!file1) {
      return null;
    };

    var previewType = (0, _PreviewFileUtils.getViewerType)(file1.extension, file1.provider);
    var compareModes = (0, _FileCompareUtils.getCompareModes)(previewType, previewType);
    var CompareIcon = (0, _FileCompareUtils.getCompareIcon)(mode);

    return _react3.default.createElement(
      'div',
      null,
      revisions && revisions.length > 1 || file1 && file2 ? _react3.default.createElement(
        _PopoverMenu2.default,
        { preferPlace: 'below' },
        _react3.default.createElement(
          _SimpleIconButton2.default,
          { title: 'Compare' },
          _react3.default.createElement(CompareIcon, { size: '20px' })
        ),
        _react3.default.createElement(
          'div',
          { className: 'PopoverMenu' },
          compareModes.map(function (item) {
            return _react3.default.createElement(
              'a',
              { key: item.value,
                className: (0, _classnames2.default)({ 'active': mode == item.value }),
                onClick: function onClick() {
                  return changeMode(item.value);
                } },
              'Compare: ',
              item.text
            );
          })
        )
      ) : null,
      enablePreview ? _react3.default.createElement(
        _SimpleIconButton2.default,
        { title: 'Open popout preview', onClick: this.preview },
        _react3.default.createElement(_openInNew2.default, { size: '20px' })
      ) : null,
      _react3.default.createElement(
        _PopoverMenu2.default,
        { preferPlace: 'below' },
        _react3.default.createElement(
          _SimpleIconButton2.default,
          { title: 'Options' },
          _react3.default.createElement(_moreHoriz2.default, { size: '20px' })
        ),
        _react3.default.createElement(_PopoverMenuList2.default, { menu: this.menu() })
      )
    );
  }
}));

///////////////////////////////// CONTAINER /////////////////////////////////

function mapStateToProps() {
  return {};
}

function mapDispatchToProps(dispatch) {
  return {
    electronWindowsActions: (0, _redux.bindActionCreators)(ElectronWindowsActions, dispatch),
    dispatch: dispatch
  };
}

exports.default = (0, _reactRedux.connect)(mapStateToProps, mapDispatchToProps)(Component);