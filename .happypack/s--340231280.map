{"version":3,"sources":["app\\renderer\\main\\modules\\Files\\PreviewFile\\PreviewCad\\AutodeskViewer\\AutodeskViewer.jsx"],"names":[],"mappings":"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","file":"AutodeskViewer.jsx","sourceRoot":"C:/Users/david/repositories/stemn-electron-2","sourcesContent":["import React from 'react';\nimport classes from './AutodeskViewer.css';\nimport autodeskViewerUtils from './autodeskViewerUtils.js';\n\nexport default React.createClass({\n  viewerInstance: null,\n  // Mounting\n  onMount (nextProps, prevProps) {\n    if(!prevProps || nextProps.urn != prevProps.urn || nextProps.token != prevProps.token){\n      setTimeout(this.init(nextProps), 1); // Timeout so refs can init\n    }\n  },\n  componentDidMount() { this.onMount(this.props) },\n  componentWillReceiveProps(nextProps) { this.onMount(nextProps, this.props)},\n  componentWillUnmount(){\n    autodeskViewerUtils.deregister(this.viewerInstance);\n  },\n  init(props) {\n    const { urn, token } = this.props;\n    const loadDocument = (viewer, options) => {\n      const onLoadCallback = (doc) => {\n        // Get all the 3D and 2D views (but keep in separate arrays so we can differentiate in the UI)\n        oViews3D = window.Autodesk.Viewing.Document.getSubItemsWithProperties(doc.getRootItem(), {\n          'type': 'geometry',\n          'role': '3d'\n        }, true);\n        oViews2D = window.Autodesk.Viewing.Document.getSubItemsWithProperties(doc.getRootItem(), {\n          'type': 'geometry',\n          'role': '2d'\n        }, true);\n\n        // Load up first a 3D view by default\n        if (oViews3D.length > 0){\n          this.viewerInstance.load(doc.getViewablePath(oViews3D[0]));\n        }\n        else if (oViews2D.length > 0){\n          this.viewerInstance.load(doc.getViewablePath(oViews2D[0]));\n        }\n        else{\n          // $mdToast.show($mdToast.simple().theme('warn').content('Error: No views found'));\n        }\n      }\n      const onErrorCallback = (errorMsg) => {\n  //          $mdToast.show($mdToast.simple().theme('warn').content('Error: '+errorMsg));\n      }\n\n      if (options.document.substring(0, 4) === 'urn:'){\n        options.document = options.document.substring(4);\n      }\n      window.Autodesk.Viewing.Document.load('urn:' + options.document, onLoadCallback, onErrorCallback);\n    }\n\n    const center = () => {\n      if(this.viewerInstance){\n        this.viewerInstance.resize()\n      }\n    }\n\n    var viewerEl = this.refs.cadCanvas;\n    var oDocument = null;\n\n    var oViewables = null,\n      oViews3D = null,\n      oViews2D = null;\n\n    var options = {\n      'document': urn,\n      'accessToken': token,\n      'env': 'AutodeskProduction'\n    };\n\n    this.viewerInstance = autodeskViewerUtils.register(viewerEl); // With toolbar\n\n    window.Autodesk.Viewing.Initializer(options, () => {\n      this.viewerInstance.initialize();\n      loadDocument(this.viewerInstance, options);\n    });\n  },\n  render() {\n    return <div className={classes.preview} ref=\"cadCanvas\"></div>\n  }\n});\n"]}