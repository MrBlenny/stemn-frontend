{"version":3,"sources":["app\\renderer\\main\\modules\\Mentions\\MentionsInput\\MentionsInput.js"],"names":[],"mappings":"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","file":"MentionsInput.js","sourceRoot":"C:/Users/david/repositories/stemn-electron-2","sourcesContent":["import React, { PropTypes } from 'react';\nimport ReactDOM from 'react-dom';\nimport LinkedValueUtils from 'react/lib/LinkedValueUtils';\n\nimport keys from 'lodash/keys';\nimport values from 'lodash/values';\nimport omit from 'lodash/omit';\nimport isEqual from 'lodash/isEqual';\n\nimport { defaultStyle } from 'substyle';\n\nimport utils from './utils';\nimport SuggestionsOverlay from './SuggestionsOverlay';\nimport Highlighter from './Highlighter';\n\nvar _getTriggerRegex = function(trigger) {\n  if(trigger instanceof RegExp) {\n    return trigger;\n  } else {\n    var escapedTriggerChar = utils.escapeRegex(trigger);\n\n    // first capture group is the part to be replaced on completion\n    // second capture group is for extracting the search query\n    return new RegExp(\"(?:^|\\\\s)(\" + escapedTriggerChar + \"([^\\\\s\" + escapedTriggerChar + \"]*))$\");\n  }\n};\n\nvar _getDataProvider = function(data) {\n  if(data instanceof Array) {\n    // if data is an array, create a function to query that\n    return function(query, callback) {\n      var results = [];\n      for(var i=0, l=data.length; i < l; ++i) {\n        var display = data[i].display || data[i].id;\n        if(display.toLowerCase().indexOf(query.toLowerCase()) >= 0) {\n          results.push(data[i]);\n        }\n      }\n      return results;\n    };\n  } else {\n    // expect data to be a query function\n    return data;\n  }\n};\n\nvar KEY = { TAB : 9, RETURN : 13, ESC : 27, UP : 38, DOWN : 40 };\n\nvar isComposing = false;\n\nconst MentionsInput = React.createClass({\n\n  displayName: 'MentionsInput',\n\n  propTypes: {\n\n    /**\n     * If set to `true` a regular text input element will be rendered\n     * instead of a textarea\n     */\n    singleLine: PropTypes.bool,\n\n    markup: PropTypes.string,\n    value: PropTypes.string,\n\n    valueLink: PropTypes.shape({\n      value: PropTypes.string,\n      requestChange: PropTypes.func\n    }),\n\n    displayTransform: PropTypes.func,\n    onKeyDown: PropTypes.func,\n    onSelect: PropTypes.func,\n    onBlur: PropTypes.func,\n    onChange: PropTypes.func,\n\n    children: PropTypes.oneOfType([\n      PropTypes.element,\n      PropTypes.arrayOf(PropTypes.element),\n    ]).isRequired\n  },\n\n  getDefaultProps: function () {\n    return {\n      markup: \"@[__display__](__id__)\",\n      singleLine: false,\n      displayTransform: function(id, display, type) {\n        return display;\n      },\n      onKeyDown: () => null,\n      onSelect: () => null,\n      onBlur: () => null,\n      style: {}\n    };\n  },\n\n  getInitialState: function () {\n    return {\n      focusIndex: 0,\n\n      selectionStart: null,\n      selectionEnd: null,\n\n      suggestions: {},\n\n      caretPosition: null,\n      suggestionsPosition: null\n    };\n  },\n\n  render: function() {\n    return (\n      <div ref=\"container\" {...substyle(this.props, getModifiers(this.props))}>\n        { this.renderControl() }\n        { this.renderSuggestionsOverlay() }\n      </div>\n    );\n  },\n\n  getInputProps: function(isTextarea) {\n    let { readOnly, disabled } = this.props;\n\n    // pass all props that we don't use through to the input control\n    let props = omit(this.props, keys(MentionsInput.propTypes));\n\n    return {\n      ...props,\n\n      ...substyle(this.props, getModifiers(this.props, \"input\")),\n\n      value: this.getPlainText(),\n\n      ...(!readOnly && !disabled && {\n        onChange: this.handleChange,\n        onSelect: this.handleSelect,\n        onKeyDown: this.handleKeyDown,\n        onBlur: this.handleBlur,\n        onCompositionStart: this.handleCompositionStart,\n        onCompositionEnd: this.handleCompositionEnd,\n      })\n    };\n  },\n\n  renderControl: function() {\n    let { singleLine } = this.props;\n    let inputProps = this.getInputProps(!singleLine);\n\n    return (\n      <div { ...substyle(this.props, getModifiers(this.props, \"control\")) }>\n        { this.renderHighlighter(inputProps.style) }\n        { singleLine ? this.renderInput(inputProps) : this.renderTextarea(inputProps) }\n      </div>\n    );\n  },\n\n  renderInput: function(props) {\n\n    return (\n      <input\n        type=\"text\"\n        ref=\"input\"\n        { ...props } />\n    );\n  },\n\n  renderTextarea: function(props) {\n    return (\n      <textarea\n        ref=\"input\"\n        { ...props } />\n    );\n  },\n\n  renderSuggestionsOverlay: function() {\n    if(!utils.isNumber(this.state.selectionStart)) {\n      // do not show suggestions when the input does not have the focus\n      return null;\n    }\n\n    let { className, style } = substyle(this.props, getModifiers(this.props, \"suggestions\"));\n\n    return (\n      <SuggestionsOverlay\n        className={ className }\n        style={{\n          ...style,\n          ...this.state.suggestionsPosition\n        }}\n        focusIndex={ this.state.focusIndex }\n        scrollFocusedIntoView={ this.state.scrollFocusedIntoView }\n        ref=\"suggestions\"\n        suggestions={this.state.suggestions}\n        onSelect={this.addMention}\n        onMouseDown={this.handleSuggestionsMouseDown}\n        onMouseEnter={ (focusIndex) => this.setState({\n          focusIndex,\n          scrollFocusedIntoView: false\n        }) }\n        isLoading={this.isLoading()} />\n    );\n  },\n\n  renderHighlighter: function(inputStyle) {\n    let { selectionStart, selectionEnd } = this.state;\n    let { markup, displayTransform, singleLine, children } = this.props;\n\n    let value = LinkedValueUtils.getValue(this.props);\n\n    return (\n      <Highlighter\n        ref=\"highlighter\"\n        { ...substyle(this.props, getModifiers(this.props, \"highlighter\")) }\n        inputStyle={ inputStyle }\n        value={ value }\n        markup={ markup }\n        displayTransform={ displayTransform }\n        singleLine={ singleLine }\n        selection={{\n          start: selectionStart,\n          end: selectionEnd\n        }}\n        onCaretPositionChange={ (position) => this.setState({ caretPosition: position }) }>\n\n        { children }\n      </Highlighter>\n    );\n  },\n\n  // Returns the text to set as the value of the textarea with all markups removed\n  getPlainText: function() {\n    var value = LinkedValueUtils.getValue(this.props) || \"\";\n    return utils.getPlainText(value, this.props.markup, this.props.displayTransform);\n  },\n\n  executeOnChange: function(event, ...args) {\n    if(this.props.onChange) {\n      return this.props.onChange(event, ...args);\n    }\n\n    if(this.props.valueLink) {\n      return this.props.valueLink.requestChange(event.target.value, ...args);\n    }\n  },\n\n  // Handle input element's change event\n  handleChange: function(ev) {\n\n    if(document.activeElement !== ev.target) {\n      // fix an IE bug (blur from empty input element with placeholder attribute trigger \"input\" event)\n      return;\n    }\n\n    var value = LinkedValueUtils.getValue(this.props) || \"\";\n    var newPlainTextValue = ev.target.value;\n\n    // Derive the new value to set by applying the local change in the textarea's plain text\n    var newValue = utils.applyChangeToValue(\n      value, this.props.markup,\n      newPlainTextValue,\n      this.state.selectionStart, this.state.selectionEnd,\n      ev.target.selectionEnd,\n      this.props.displayTransform\n    );\n\n    // In case a mention is deleted, also adjust the new plain text value\n    newPlainTextValue = utils.getPlainText(newValue, this.props.markup, this.props.displayTransform);\n\n    // Save current selection after change to be able to restore caret position after rerendering\n    var selectionStart = ev.target.selectionStart;\n    var selectionEnd = ev.target.selectionEnd;\n    var setSelectionAfterMentionChange = false;\n\n    // Adjust selection range in case a mention will be deleted by the characters outside of the\n    // selection range that are automatically deleted\n    var startOfMention = utils.findStartOfMentionInPlainText(value, this.props.markup, selectionStart, this.props.displayTransform);\n\n    if(startOfMention !== undefined && this.state.selectionEnd > startOfMention) {\n      // only if a deletion has taken place\n      selectionStart = startOfMention;\n      selectionEnd = selectionStart;\n      setSelectionAfterMentionChange = true;\n    }\n\n    this.setState({\n      selectionStart: selectionStart,\n      selectionEnd: selectionEnd,\n      setSelectionAfterMentionChange: setSelectionAfterMentionChange,\n    });\n\n    var mentions = utils.getMentions(newValue, this.props.markup);\n\n    // Propagate change\n    // var handleChange = this.getOnChange(this.props) || emptyFunction;\n    var eventMock = { target: { value: newValue } };\n    // this.props.onChange.call(this, eventMock, newValue, newPlainTextValue, mentions);\n    this.executeOnChange(eventMock, newValue, newPlainTextValue, mentions);\n  },\n\n  // Handle input element's select event\n  handleSelect: function(ev) {\n    // do nothing while a IME composition session is active\n    if (isComposing) return;\n\n    // keep track of selection range / caret position\n    this.setState({\n      selectionStart: ev.target.selectionStart,\n      selectionEnd: ev.target.selectionEnd\n    });\n\n    // refresh suggestions queries\n    var el = this.refs.input;\n    if(ev.target.selectionStart === ev.target.selectionEnd) {\n      this.updateMentionsQueries(el.value, ev.target.selectionStart);\n    } else {\n      this.clearSuggestions();\n    }\n\n    // sync highlighters scroll position\n    this.updateHighlighterScroll();\n\n    this.props.onSelect(ev);\n  },\n\n  handleKeyDown: function(ev) {\n    // do not intercept key events if the suggestions overlay is not shown\n    var suggestionsCount = utils.countSuggestions(this.state.suggestions);\n\n    var suggestionsComp = this.refs.suggestions;\n    if(suggestionsCount === 0 || !suggestionsComp) {\n      this.props.onKeyDown(ev);\n\n      return;\n    }\n\n    if(values(KEY).indexOf(ev.keyCode) >= 0) {\n      ev.preventDefault();\n    }\n\n    switch(ev.keyCode) {\n      case KEY.ESC: {\n        this.clearSuggestions();\n        return;\n      }\n      case KEY.DOWN: {\n        this.shiftFocus(+1);\n        return;\n      }\n      case KEY.UP: {\n        this.shiftFocus(-1);\n        return;\n      }\n      case KEY.RETURN: {\n        this.selectFocused();\n        return;\n      }\n      case KEY.TAB: {\n        this.selectFocused();\n        return;\n      }\n    }\n  },\n\n  shiftFocus: function(delta) {\n    let suggestionsCount = utils.countSuggestions(this.state.suggestions);\n\n    this.setState({\n      focusIndex: (suggestionsCount + this.state.focusIndex + delta) % suggestionsCount,\n      scrollFocusedIntoView: true\n    });\n  },\n\n  selectFocused: function() {\n    let { suggestions, focusIndex } = this.state;\n    let { suggestion, descriptor } = utils.getSuggestion(suggestions, focusIndex);\n\n    this.addMention(suggestion, descriptor);\n\n    this.setState({\n      focusIndex: 0\n    });\n  },\n\n  handleBlur: function(ev) {\n    // only reset selection if the mousedown happened on an element\n    // other than the suggestions overlay\n    if(!this._suggestionsMouseDown) {\n      this.setState({\n        selectionStart: null,\n        selectionEnd: null\n      });\n    };\n    this._suggestionsMouseDown = false;\n\n    window.setTimeout(() => {\n      this.updateHighlighterScroll();\n    }, 1);\n\n    // do not intercept key events if the suggestions overlay is not shown\n    const suggestionsShown = utils.countSuggestions(this.state.suggestions) > 0;\n    this.props.onBlur(ev, suggestionsShown);\n  },\n\n  handleSuggestionsMouseDown: function(ev) {\n    this._suggestionsMouseDown = true;\n  },\n\n  updateSuggestionsPosition: function() {\n    let { caretPosition } = this.state;\n\n    if(!caretPosition || !this.refs.suggestions) {\n      return;\n    }\n\n    let { container } = this.refs;\n\n    let suggestions = ReactDOM.findDOMNode(this.refs.suggestions);\n    let highlighter = ReactDOM.findDOMNode(this.refs.highlighter);\n\n    if(!suggestions) {\n      return;\n    }\n\n    let left = caretPosition.left - highlighter.scrollLeft;\n    let position = {};\n\n    // guard for mentions suggestions list clipped by right edge of window\n    if (left + suggestions.offsetWidth > container.offsetWidth) {\n      position.right = 0;\n    } else {\n      position.left = left\n    }\n\n    position.top = caretPosition.top - highlighter.scrollTop;\n\n    if(isEqual(position, this.state.suggestionsPosition)) {\n      return;\n    }\n\n    this.setState({\n      suggestionsPosition: position\n    });\n  },\n\n  updateHighlighterScroll: function() {\n    if(!this.refs.input || !this.refs.highlighter) {\n      // since the invocation of this function is deferred,\n      // the whole component may have been unmounted in the meanwhile\n      return;\n    }\n    var input = this.refs.input;\n    var highlighter = ReactDOM.findDOMNode(this.refs.highlighter);\n    highlighter.scrollLeft = input.scrollLeft;\n  },\n\n  handleCompositionStart: function() {\n    isComposing = true;\n  },\n\n  handleCompositionEnd: function() {\n    isComposing = false;\n  },\n\n  componentDidMount: function() {\n    this.updateSuggestionsPosition();\n  },\n\n  componentDidUpdate: function() {\n    this.updateSuggestionsPosition();\n\n    // maintain selection in case a mention is added/removed causing\n    // the cursor to jump to the end\n    if (this.state.setSelectionAfterMentionChange) {\n      this.setState({setSelectionAfterMentionChange: false});\n      this.setSelection(this.state.selectionStart, this.state.selectionEnd);\n    }\n  },\n\n  setSelection: function(selectionStart, selectionEnd) {\n    if(selectionStart === null || selectionEnd === null) return;\n\n    var el = this.refs.input;\n    if(el.setSelectionRange) {\n      el.setSelectionRange(selectionStart, selectionEnd);\n    }\n    else if(el.createTextRange) {\n      var range = el.createTextRange();\n      range.collapse(true);\n      range.moveEnd('character', selectionEnd);\n      range.moveStart('character', selectionStart);\n      range.select();\n    }\n  },\n\n  updateMentionsQueries: function(plainTextValue, caretPosition) {\n    // Invalidate previous queries. Async results for previous queries will be neglected.\n    this._queryId++;\n    this.setState({\n      suggestions: {}\n    });\n\n    // If caret is inside of or directly behind of mention, do not query\n    var value = LinkedValueUtils.getValue(this.props) || \"\";\n    if( utils.isInsideOfMention(value, this.props.markup, caretPosition, this.props.displayTransform) ||\n        utils.isInsideOfMention(value, this.props.markup, caretPosition-1, this.props.displayTransform) ) {\n      return;\n    }\n\n    // Check if suggestions have to be shown:\n    // Match the trigger patterns of all Mention children the new plain text substring up to the current caret position\n    var substring = plainTextValue.substring(0, caretPosition);\n\n    var that = this;\n    React.Children.forEach(this.props.children, function(child) {\n      if(!child) {\n        return;\n      }\n\n      var regex = _getTriggerRegex(child.props.trigger);\n      var match = substring.match(regex);\n      if(match) {\n        var querySequenceStart = substring.indexOf(match[1], match.index);\n        that.queryData(match[2], child, querySequenceStart, querySequenceStart+match[1].length, plainTextValue);\n      }\n    });\n  },\n\n  clearSuggestions: function() {\n    // Invalidate previous queries. Async results for previous queries will be neglected.\n    this._queryId++;\n    this.setState({\n      suggestions: {},\n      focusIndex: 0\n    });\n  },\n\n  queryData: function(query, mentionDescriptor, querySequenceStart, querySequenceEnd, plainTextValue) {\n    var provideData = _getDataProvider(mentionDescriptor.props.data);\n    var snycResult = provideData(query, this.updateSuggestions.bind(null, this._queryId, mentionDescriptor, query, querySequenceStart, querySequenceEnd, plainTextValue));\n    if(snycResult instanceof Array) {\n      this.updateSuggestions(this._queryId, mentionDescriptor, query, querySequenceStart, querySequenceEnd, plainTextValue, snycResult);\n    }\n  },\n\n  updateSuggestions: function(queryId, mentionDescriptor, query, querySequenceStart, querySequenceEnd, plainTextValue, suggestions) {\n    // neglect async results from previous queries\n    if(queryId !== this._queryId) return;\n\n    var update = {};\n    update[mentionDescriptor.props.type] = {\n      query: query,\n      mentionDescriptor: mentionDescriptor,\n      querySequenceStart: querySequenceStart,\n      querySequenceEnd: querySequenceEnd,\n      results: suggestions,\n      plainTextValue: plainTextValue\n    };\n\n    this.setState({\n      suggestions: utils.extend({}, this.state.suggestions, update)\n    });\n  },\n\n  addMention: function(suggestion, {mentionDescriptor, querySequenceStart, querySequenceEnd, plainTextValue}) {\n    // Insert mention in the marked up value at the correct position\n    var value = LinkedValueUtils.getValue(this.props) || \"\";\n    var start = utils.mapPlainTextIndex(value, this.props.markup, querySequenceStart, 'START', this.props.displayTransform);\n    var end = start + querySequenceEnd - querySequenceStart;\n    var insert = utils.makeMentionsMarkup(this.props.markup, suggestion.id, suggestion.display, mentionDescriptor.props.type);\n    if (mentionDescriptor.props.appendSpaceOnAdd) {\n      insert = insert + ' '\n    }\n    var newValue = utils.spliceString(value, start, end, insert);\n\n    // Refocus input and set caret position to end of mention\n    this.refs.input.focus();\n\n    var displayValue = this.props.displayTransform(suggestion.id, suggestion.display, mentionDescriptor.props.type);\n    if (mentionDescriptor.props.appendSpaceOnAdd) {\n      displayValue = displayValue + ' '\n    }\n    var newCaretPosition = querySequenceStart + displayValue.length;\n    this.setState({\n      selectionStart: newCaretPosition,\n      selectionEnd: newCaretPosition,\n      setSelectionAfterMentionChange: true\n    });\n\n    // Propagate change\n    var eventMock = { target: { value: newValue }};\n    var mentions = utils.getMentions(newValue, this.props.markup);\n    var newPlainTextValue = utils.spliceString(plainTextValue, querySequenceStart, querySequenceEnd, displayValue);\n\n    this.executeOnChange(eventMock, newValue, newPlainTextValue, mentions);\n\n    var onAdd = mentionDescriptor.props.onAdd;\n    if(onAdd) {\n      onAdd(suggestion.id, suggestion.display);\n    }\n\n    // Make sure the suggestions overlay is closed\n    this.clearSuggestions();\n  },\n\n  isLoading: function() {\n    var isLoading = false;\n    React.Children.forEach(this.props.children, function(child) {\n      isLoading = isLoading || child && child.props.isLoading;\n    });\n    return isLoading;\n  },\n\n  _queryId: 0\n\n\n});\n\nexport default MentionsInput;\n\nconst getModifiers = (props, ...modifiers) => ({\n  ...modifiers.reduce((result, modifier) => ({ ...result, [modifier]: true }), {}),\n\n  \"&singleLine\": props.singleLine,\n  \"&multiLine\": !props.singleLine,\n});\n\nconst isMobileSafari = typeof navigator !== 'undefined' && /iPhone|iPad|iPod/i.test(navigator.userAgent);\n\nconst substyle = defaultStyle({\n  position: \"relative\",\n  overflowY: \"visible\",\n\n  input: {\n    display: \"block\",\n    position: \"absolute\",\n\n    top: 0,\n\n    boxSizing: \"border-box\",\n\n    backgroundColor: \"transparent\",\n\n    width: \"inherit\",\n  },\n\n  '&multiLine': {\n    input: {\n      width: \"100%\",\n      height: \"100%\",\n      bottom: 0,\n      overflow: \"hidden\",\n      resize: \"none\",\n\n      // fix weird textarea padding in mobile Safari (see: http://stackoverflow.com/questions/6890149/remove-3-pixels-in-ios-webkit-textarea)\n      ...(isMobileSafari ? {\n        marginTop: 1,\n        marginLeft: -3,\n      } : null)\n    }\n  }\n});\n"]}