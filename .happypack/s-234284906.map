{"version":3,"sources":["app\\shared\\reducers\\projects.js"],"names":[],"mappings":"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","file":"projects.js","sourceRoot":"C:/Users/david/repositories/stemn-electron-2","sourcesContent":["import { modeled } from 'react-redux-form';\nimport i from 'icepick';\n\nconst initialState = {\n  data: {},\n  activeProject: '',        // The currently active project\n  userProjects: {\n    loading: false,\n    data: []\n  },\n  newProject: {\n    summary: '',\n    name: '',\n    savePending: ''\n  }\n}\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'PROJECTS/SET_ACTIVE_PROJECT':\n      return {...state,\n        activeProject: action.payload.projectId\n      }\n    case 'PROJECTS/GET_PROJECT_FULFILLED' :\n      return i.assocIn(state, ['data', action.payload.data._id, 'data'], action.payload.data)\n    case 'PROJECTS/ADD_TEAM_MEMBER' :\n      return i.updateIn(state, ['data', action.payload.projectId, 'data', 'team'], (team) => {\n        const modifiedUser = Object.assign({}, action.payload.user, {permissions: {role: 'admin'}})\n        return i.push(team, modifiedUser)\n      })\n    case 'PROJECTS/CHANGE_USER_PERMISSIONS' :\n      return i.updateIn(state, ['data', action.payload.projectId, 'data', 'team'], (team) => {\n        const index = team.findIndex((user)=>user._id == action.payload.userId);\n        return [\n          ...team.slice(0, index),\n          i.assocIn(team[index], ['permissions', 'role'], action.payload.role),\n          ...team.slice(index + 1)\n        ]\n      })\n    case 'PROJECTS/REMOVE_TEAM_MEMBER' :\n      return i.updateIn(state, ['data', action.payload.projectId, 'data', 'team'], (team) => {\n        const index = team.findIndex((user)=>user._id == action.payload.userId);\n        return  [\n          ...team.slice(0, index),\n          ...team.slice(index+ 1)\n        ]\n      });\n    case 'PROJECTS/LINK_REMOTE_PENDING' :\n      return i.assocIn(state, ['data', action.meta.cacheKey, 'linkPending'], true);\n    case 'PROJECTS/LINK_REMOTE_FULFILLED' :\n      return i.chain(state)\n      .assocIn(['data', action.meta.cacheKey, 'linkPending'], false)\n      .assocIn(['data', action.meta.cacheKey, 'data', 'remote'], action.payload.data)\n      .value();\n    case 'PROJECTS/LINK_REMOTE_REJECTED' :\n      return i.assocIn(state, ['data', action.meta.cacheKey, 'linkPending'], false);\n\n\n    case 'PROJECTS/GET_USER_PROJECTS_PENDING':\n      return i.assocIn(state, ['userProjects', 'loading'], true)\n    case 'PROJECTS/GET_USER_PROJECTS_FULFILLED':\n      return i.assocIn(state, ['userProjects'], {loading: false, data: action.payload.data})\n    case 'PROJECTS/GET_USER_PROJECTS_REJECTED':\n      return i.assocIn(state, ['userProjects', 'loading'], false)\n\n    case 'PROJECTS/CREATE_PROJECT_PENDING':\n      return i.assocIn(state, ['newProject', 'savePending'], true)\n    case 'PROJECTS/CREATE_PROJECT_REJECTED':\n      return i.assocIn(state, ['newProject', 'savePending'], false)\n    case 'PROJECTS/CREATE_PROJECT_FULFILLED':\n      return i.chain(state)\n      .assoc('newProject', {})                             // Clear the newProject object\n      .updateIn(['userProjects', 'data'], (projects) => {  // Push the new project onto the userProjects array\n        return i.push(projects, action.payload.data);\n      })\n      .value();\n\n    case 'PROJECTS/SAVE_PROJECT_PENDING':\n      return i.assocIn(state, ['data', action.meta.projectId, 'savePending'], true)\n    case 'PROJECTS/SAVE_PROJECT_FULFILLED':\n      return i.assocIn(state, ['data', action.meta.projectId, 'savePending'], false)\n    case 'PROJECTS/SAVE_PROJECT_REJECTED':\n      return i.assocIn(state, ['data', action.meta.projectId, 'savePending'], false)\n\n    case 'PROJECTS/DELETE_PROJECT_FULFILLED' :\n      return i.chain(state)\n      .assocIn(['data', action.meta.projectId], undefined) // Delete the project from the main store\n      .updateIn(['userProjects', 'data'], (projects) => {  // Delete it from the userProjects list\n        const projectIndex = projects.findIndex( project => project._id == action.meta.projectId);\n        return i.splice(projects, projectIndex, 1);\n      })\n      .value();\n    default:\n        return state;\n  }\n}\n\nexport default function (state = initialState, action) {\n  if (!state.hydrated) {\n    state = { ...initialState, ...state, hydrated: true };\n  }\n  return modeled(reducer, 'projects')(state, action)\n}\n"]}